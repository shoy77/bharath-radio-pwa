<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bharath Radio</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icons/icon-192.png" />
  <meta name="theme-color" content="#2196f3" />
  </head>
   <body>

  <!-- Header: Station Info & Visualizer -->
  <header>
    <div class="station-name" id="stationName">Bharath FM ‚Äî OFF</div>
    <div class="frequency" id="frequencyDisplay">--.- MHz</div>
    <div class="indicator" id="indicator"></div>
    <canvas id="visualizer"></canvas>
  </header>

  <!-- Main Content -->
  <div class="ipod">
    <audio id="player" preload="auto" crossorigin="anonymous"></audio>
    <div>üéµ Radio Playing...</div>
  </div>

  <!-- Footer: Wheel & Buttons -->
  <footer>
    <div class="wheel">
      <button class="left-btn" onclick="prevStation()">‚èÆ</button>
      <button class="right-btn" onclick="nextStation()">‚è≠</button>
      <button class="center-button" onclick="togglePower()" id="powerBtn">‚èª</button>
    </div>
  </footer>

  <script>
    const stations = [
      { name: "Tamil FM Dubai", freq: "89.4", url: "https://centova.aarenworld.com/proxy/894tamilfm/stream" },
      { name: "Radio Macfast", freq: "90.42", url: "https://icecast.octosignals.com/radiomacfast" },
      { name: "Radio Mango", freq: "91.9", url: "https://listen.openstream.co/4635/audio" },
      { name: "Radio Paradise", freq: "107.9", url: "https://stream.radioparadise.com/mp3-128" }
    ];

    let current = 0;
    let isOn = false;

    const player = document.getElementById("player");
    const stationName = document.getElementById("stationName");
    const freqDisplay = document.getElementById("frequencyDisplay");
    const powerBtn = document.getElementById("powerBtn");
    const indicator = document.getElementById("indicator");

    function loadStation(index) {
      const station = stations[index];
      player.src = station.url;
      freqDisplay.textContent = `${station.freq} MHz`;
      stationName.textContent = station.name;
      player.play().catch(err => console.warn("Autoplay issue:", err));
    }

    function togglePower() {
      isOn = !isOn;
      if (isOn) {
        indicator.classList.add("on");
        powerBtn.classList.add("on");
        if (audioContext.state === "suspended") {
          audioContext.resume();
        }
        loadStation(current);
        drawVisualizer();
      } else {
        indicator.classList.remove("on");
        powerBtn.classList.remove("on");
        player.pause();
        freqDisplay.textContent = "--.- MHz";
        stationName.textContent = "Bharath FM ‚Äî OFF";
      }
    }

    function nextStation() {
      if (!isOn) return;
      current = (current + 1) % stations.length;
      loadStation(current);
    }

    function prevStation() {
      if (!isOn) return;
      current = (current - 1 + stations.length) % stations.length;
      loadStation(current);
    }

    // üéõ Visualizer Setup
    const canvas = document.getElementById("visualizer");
    const ctx = canvas.getContext("2d");
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    const analyser = audioContext.createAnalyser();
    const source = audioContext.createMediaElementSource(player);
    source.connect(analyser);
    analyser.connect(audioContext.destination);
    analyser.fftSize = 64;

    const bufferLength = analyser.frequencyBinCount;
    const dataArray = new Uint8Array(bufferLength);

    function drawVisualizer() {
      requestAnimationFrame(drawVisualizer);
      analyser.getByteFrequencyData(dataArray);

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      const barWidth = canvas.width / bufferLength;
      let x = 0;

      for (let i = 0; i < bufferLength; i++) {
        const barHeight = dataArray[i];
        const hue = (i / bufferLength) * 360;
        ctx.fillStyle = `hsl(${hue}, 100%, 50%)`;
        ctx.fillRect(x, canvas.height - barHeight, barWidth - 1, barHeight);
        x += barWidth;
      }
    }
  
  <!-- Splash screen -->

<div id="splash" style="
  background-image: url('icons/splash-720x1280.png');
  background-size: cover;
  background-position: center;
  width: 100vw;
  height: 100vh;
">
</div>
  

  <!-- Main App -->
  <div id="mainApp">
    <div class="ipod">
      <div class="screen">
        <div class="frequency" id="frequency">--.- MHz</div>
        <div class="station" id="stationName">OFF</div>
        <div class="indicator" id="indicator"></div>
        <canvas id="visualizer" width="280" height="250"></canvas>
      </div>
      <div class="wheel">
        <button class="left-btn" onclick="prevStation()">‚èÆ</button>
        <button class="right-btn" onclick="nextStation()">‚è≠</button>
        <button class="center-button" onclick="togglePower()" id="powerBtn">
          <svg viewBox="0 0 24 24">
            <path d="M12 2V12" />
            <path d="M5.5 7A9 9 0 1 0 18.5 7" />
          </svg>
        </button>
      </div>
      <audio id="player" preload="auto" crossorigin="anonymous"></audio>

    </div>
  </div>

 
    // Splash transition
    window.addEventListener("load", () => {
      setTimeout(() => {
        document.getElementById("splash").style.display = "none";
        const app = document.getElementById("mainApp");
app.style.display = "flex";
setTimeout(() => app.classList.add("visible"), 10); // Fade in
      }, 4000);
    });

    const stations = [
      { name: "Tamil FM Dubai", freq: "89.4", url: "https://centova.aarenworld.com/proxy/894tamilfm/stream" },
      { name: "Ashraya FM Kottarakara", freq: "90.0", url: "https://fm.ashrayafm90.com/ashrayafm" },
      { name: "Ahalia FM Palakkad", freq: "90.41", url: "https://cast1.my-control-panel.com/proxy/ahaliafm/stream" },
      { name: "Radio Macfast Thiruvalla", freq: "90.42", url: "https://icecast.octosignals.com/radiomacfast" },   
      { name: "Radio Lemon Bangalore", freq: "90.5", url: "https://schedule.radiolemonlive.com:7443/listen/radio_lemon_live_bangalore/live" },
      { name: "91.7 FM Qatar", freq: "91.7", url: "https://playerservices.streamtheworld.com/api/livestream-redirect/SUNO917_SC" },
      { name: "Radio Mango", freq: "91.9", url: "https://listen.openstream.co/4635/audio" },
      { name: "Suryan FM", freq: "93.5", url: "https://radios.crabdance.com:8002/2" },
      { name: "Club FM", freq: "94.3", url: "https://listen.openstream.co/4635/audio" },
      { name: "Radio Asia", freq: "94.7", url: "https://ice31.securenetsystems.net/RADIOKERAL" },
      { name: "Red FM Mumbai", freq: "95.0", url: "https://funasia.streamguys1.com/live9" },
      { name: "Radio Mirchi", freq: "98.3", url: "https://playerservices.streamtheworld.com/api/livestream-redirect/NJS_HIN_ESTAAC.m3u8" },
      { name: "Radio Malayalam Qatar", freq: "98.6", url: "https://stream.zeno.fm/512rbf1e3qzuv" },
      { name: "Adithya FM", freq: "99.9", url: "https://stream.zeno.fm/9x1sw687nf9uv" },
      { name: "Ananthapuri FM",  freq: "101.9", url: "https://air.pc.cdn.bitgravity.com/air/live/pbaudio229/playlist.m3u8" },
      { name: "Kochi FM",      freq: "102.3", url: "https://air.pc.cdn.bitgravity.com/air/live/pbaudio045/playlist.m3u8" },
      { name: "Akashavani Thiruvanathapuram", freq: "102.9", url: "https://air.pc.cdn.bitgravity.com/air/live/pbaudio230/playlist.m3u8" },
      { name: "Rainbow FM", freq: "104.5", url: "https://air.pc.cdn.bitgravity.com/air/live/pbaudio045/playlist" },
      { name: "Vividh Bharati", freq: "107.5", url: "https://air.pc.cdn.bitgravity.com/air/live/pbaudio001/playlist.m3u8" },
      { name: "Kiss FM UK", freq: "107.6", url: "https://edge-bauerall-01-gos2.sharp-stream.com/kissnational.aac" },
      { name: "Hit Music FM", freq: "107.7", url: "https://playerservices.streamtheworld.com/api/livestream-redirect/KZGFFMAAC.aac" },
      { name: "Hit FM", freq: "107.8", url: "https://stream.revma.ihrhls.com/zc5299" },
      { name: "Radio Paradise", freq: "107.9", url: "https://stream.radioparadise.com/mp3-128" },
    ];

    let current = 0;
    let isOn = false;

    const player = document.getElementById("player");
    const freqDisplay = document.getElementById("frequency");
    const nameDisplay = document.getElementById("stationName");
    const indicator = document.getElementById("indicator");
    const powerBtn = document.getElementById("powerBtn");

    function loadStation(index) {
      const station = stations[index];
      player.src = station.url;
      freqDisplay.textContent = `${station.freq} MHz`;
      nameDisplay.textContent = station.name;
      player.play().catch(err => console.error("Autoplay error:", err));
    }

    function nextStation() {
      if (!isOn) return;
      current = (current + 1) % stations.length;
      loadStation(current);
    }

    function prevStation() {
      if (!isOn) return;
      current = (current - 1 + stations.length) % stations.length;
      loadStation(current);
    }

    function togglePower() {
      isOn = !isOn;
      if (isOn) {
        indicator.classList.add("on");
        powerBtn.classList.add("on");
        if (audioContext.state === 'suspended') {
          audioContext.resume();
        }
        loadStation(current);
        drawVisualizer();
      } else {
        indicator.classList.remove("on");
        powerBtn.classList.remove("on");
        player.pause();
        freqDisplay.textContent = "Bharath Radio";
        nameDisplay.textContent = "OFF";
      }
    }

    const canvas = document.getElementById("visualizer");
    const ctx = canvas.getContext("2d");


const audioContext = new (window.AudioContext || window.webkitAudioContext)();
  const analyser = audioContext.createAnalyser();
  const source = audioContext.createMediaElementSource(player);
  source.connect(analyser);
  analyser.connect(audioContext.destination);
  analyser.fftSize = 64;

  const bufferLength = analyser.frequencyBinCount;
  const dataArray = new Uint8Array(bufferLength);


    
    

    function drawVisualizer() {
      requestAnimationFrame(drawVisualizer);
      analyser.getByteFrequencyData(dataArray);

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      const barWidth = canvas.width / bufferLength;
      let x = 0;

      for (let i = 0; i < bufferLength; i++) {
        const barHeight = dataArray[i];
        const hue = (i / bufferLength) * 360;
        ctx.fillStyle = `hsl(${hue}, 100%, 50%)`;
        ctx.fillRect(x, canvas.height - barHeight, barWidth - 1, barHeight);
        x += barWidth;
      }
    }
  </script>
</body>
</html>
